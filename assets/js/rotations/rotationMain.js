function getAxisAngleFromQuaternion(e){var r,a=2*Math.acos(e.w);return r=1-e.w*e.w<1e-6?1:Math.sqrt(1-e.w*e.w),a>Math.PI&&(a=2*Math.PI-a,r=-r),[e.x/r*a,e.y/r*a,e.z/r*a]}for(var quaternion_changed=function(){for(var e=0,r=0;r<4;r++){var a=(s=quaternion_arr[r][0]).value;if(s==this)var n=1-a*a;else e+=a*a}var t=Math.sqrt(n/e),l=0,i=[];for(r=0;r<4;r++){(s=quaternion_arr[r][0])!=this&&(s.value*=t),i.push(s.value),0!=s.value&&l++}var o=(new THREE.Quaternion).fromArray(i).normalize();for(set_euler_angles(o),set_axis_angle(o);1==l&1!=this.value;){l=0;for(r=0;r<4;r++){var s;0==(s=quaternion_arr[r][0]).value&&(s.value=(Math.floor(3*Math.random())-1)*s.step),0!=s.value&&l++}}for(r=0;r<4;r++)quaternion_arr[r][1].innerHTML=quaternion_arr[r][0].value},eulerhtml=document.getElementById("euler"),set_euler_angles=function(e){for(var r=(new THREE.Euler).setFromQuaternion(e).toArray(),a=0;a<3;a++){var n=eulerhtml.rows[a].cells[1].firstChild,t=eulerhtml.rows[a].cells[2];n.value=r[a],t.innerHTML=parseFloat(n.value).toFixed(2)}},euler_angles_changed=function(){for(var e=[],r=0;r<3;r++){var a=eulerhtml.rows[r].cells[1].firstChild,n=eulerhtml.rows[r].cells[2];e.push(parseFloat(a.value)),n.innerHTML=parseFloat(a.value).toFixed(2)}var t=(new THREE.Quaternion).setFromEuler((new THREE.Euler).fromArray(e));set_quaternion(t),set_axis_angle(t)},axisanglehtml=document.getElementById("axis-angle"),set_axis_angle=function(e){for(var r=getAxisAngleFromQuaternion(e),a=0;a<3;a++){var n=axisanglehtml.rows[a].cells[1].firstChild,t=axisanglehtml.rows[a].cells[2];n.value=r[a],t.innerHTML=parseFloat(n.value).toFixed(2)}},axis_angle_changed=function(){for(var e=[],r=0;r<3;r++){var a=axisanglehtml.rows[r].cells[1].firstChild,n=axisanglehtml.rows[r].cells[2];e.push(a.value),n.innerHTML=parseFloat(a.value).toFixed(2)}var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);for(r=0;r<3;r++)e[r]/=t;var l=(new THREE.Vector3).fromArray(e),i=(new THREE.Quaternion).setFromAxisAngle(l,t);set_quaternion(i),set_euler_angles(i)},set_quaternion=function(e){for(var r=e.toArray(),a=0,n=0,t=0;t<4;t++){var l=quaternion_arr[t][0];a+=Math.abs(r[t]-parseFloat(l.value)),n+=Math.abs(r[t]+parseFloat(l.value)),l.value=r[t]}for(t=0;t<4;t++){l=quaternion_arr[t][0];var i=quaternion_arr[t][1];n<a&&(r[t]=-r[t]),l.value=r[t],i.innerHTML=parseFloat(l.value).toFixed(3)}},quaternion_arr=[],quaternion_table=document.getElementById("quaternion"),i=0;i<4;i++){var slider=quaternion_table.rows[i].cells[1].firstChild,output=quaternion_table.rows[i].cells[2];slider.oninput=quaternion_changed,quaternion_arr.push([slider,output])}slider.dispatchEvent(new Event("input"));for(i=0;i<3;i++)eulerhtml.rows[i].cells[1].firstChild.oninput=euler_angles_changed,axisanglehtml.rows[i].cells[1].firstChild.oninput=axis_angle_changed;rotationhtml=document.getElementById("rotation"),init();